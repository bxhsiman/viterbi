# Viterbi解码器 ASIC设计项目

## 项目概述

本项目实现了一个完整的Viterbi解码器ASIC设计，包括编码器和解码器两部分。编码器采用(2,1,8)卷积编码，约束长度K=9；解码器使用经典的Viterbi算法进行软判决解码。整个设计采用Verilog HDL实现，支持流水线处理。

## 技术规格

### 编码参数
- **约束长度**: K = 9
- **编码率**: R = 1/2 (1位输入产生2位输出)
- **生成多项式**:
  - G1 = 110101111 (八进制557)
  - G2 = 100011101 (八进制435)
- **状态数**: 256 (2^(K-1))

### 解码器架构
- **并行ACS单元**: 4个
- **分支度量计算**: 硬判决汉明距离
- **路径度量位宽**: 8位
- **回溯深度**: 可配置，最小5*(K-1)

## 文件结构

```
├── decoder.v              # Viterbi解码器顶层模块
├── viterbi_encode9.v       # (2,1,8)卷积编码器
├── params.v                # 全局参数定义文件
├── tb_correct.v            # 无误码测试平台
├── tb_err.v                # 含误码测试平台
│
├── rtl/                    # RTL设计文件目录
│   ├── acs.v               # 加比选(ACS)单元
│   ├── bmg.v               # 分支度量生成器
│   ├── control.v           # 控制单元
│   ├── dff.v               # D触发器模块
│   ├── mmu.v               # 存储器管理单元
│   ├── ram.v               # 存储器模块
│   └── tbu.v               # 回溯单元
│
└── tb/                     # 子模块测试文件目录
    ├── tb_acs.v            # ACS单元测试
    ├── tb_bmg.v            # BMG单元测试
    ├── tb_control.v        # 控制单元测试
    ├── tb_metricmemory.v   # 度量存储器测试
    ├── tb_mmu.v            # MMU单元测试
    ├── tb_mmu2.v           # MMU扩展测试
    ├── tb_ram.v            # RAM模块测试
    └── tb_tbu.v            # TBU单元测试
```

## 主要模块说明

### 1. VITERBIDECODER (decoder.v)
- **功能**: 解码器顶层模块，集成所有子模块
- **输入**: Reset, CLOCK, Active, Code[1:0]
- **输出**: DecodeOut
- **特点**: 流水线架构，支持连续解码

### 2. viterbi_encode9 (viterbi_encode9.v)
- **功能**: 卷积编码器
- **输入**: X, Clock, Reset
- **输出**: Y[1:0]
- **特点**: 8级移位寄存器，双生成多项式

### 3. CONTROL (rtl/control.v)
- **功能**: 系统控制单元
- **特点**: 双时钟生成，状态计数，时序控制

### 4. BMG (rtl/bmg.v)
- **功能**: 分支度量生成器
- **特点**: 计算8个分支的汉明距离

### 5. ACSUNIT (rtl/acs.v)
- **功能**: 加比选运算单元
- **特点**: 4个并行ACS处理器，路径度量更新

### 6. MMU (rtl/mmu.v)
- **功能**: 存储器管理单元
- **特点**: 协调RAM读写，数据位宽转换

### 7. TBU (rtl/tbu.v)
- **功能**: 回溯单元
- **特点**: 从最优路径回溯，恢复原始数据

### 8. RAM & METRICMEMORY (rtl/ram.v)
- **功能**: 存储器模块
- **特点**: 双缓冲结构，支持并发读写

## 仿真测试

### 1. 无误码测试 (tb_correct.v)
- 测试无信道误码情况下的编解码性能
- 验证编码器和解码器的正确性

### 2. 含误码测试 (tb_err.v)
- 测试信道引入随机误码后的解码性能
- 评估误码纠正能力

### 3. 单元测试 (tb/目录)
- 对各个子模块进行独立测试
- 验证模块接口和功能正确性

## 编译运行

### 使用ModelSim/QuestaSim
```bash
vlog *.v rtl/*.v
vsim -voptargs=+acc tb_correct
run -all
```

### 使用Vivado
1. 创建新项目
2. 添加所有.v文件
3. 设置tb_correct为顶层模块
4. 运行仿真

### 使用开源工具(Icarus Verilog)
```bash
iverilog -o sim tb_correct.v
vvp sim
gtkwave tb_correct.vcd
```

## 波形查看

仿真运行后会生成.vcd波形文件：
- `tb_correct.vcd`: 无误码测试波形
- `vd_err.vcd`: 含误码测试波形

### 关键信号观察
- **输入**: X (原始数据), Code (编码数据)
- **输出**: DecodeOut (解码数据)
- **内部**: 路径度量、生存路径、控制信号

## 设计特点

1. **模块化设计**: 各功能模块独立，便于测试和维护
2. **参数化配置**: 通过params.v统一管理设计参数
3. **流水线架构**: 支持连续数据处理，提高吞吐量
4. **双缓冲存储**: 避免读写冲突，保证数据完整性
5. **时钟域管理**: 双相时钟设计，确保时序正确

## 性能指标

- **最大工作频率**: 取决于关键路径延迟
- **吞吐量**: 每时钟周期处理1个编码符号
- **纠错能力**: 理论上可纠正1位/约束长度的随机误码
- **延迟**: 约束长度 × 回溯深度的处理延迟

## 注意事项

1. **复位序列**: 必须正确执行复位序列，确保初始状态正确
2. **时钟关系**: Clock1和Clock2为双相时钟，存在相位关系
3. **激活时序**: Active信号需要在有效数据到来时拉高
4. **回溯深度**: 回溯深度影响解码延迟和纠错性能的平衡
   
2025 ASIC设计实验 - Readme 由 Claude Sonnet 4 生成
